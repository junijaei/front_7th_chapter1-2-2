# Product Requirements Document (PRD)

**프로젝트명**: 캘린더 반복 일정 기능
**프로젝트 ID**: PROJ-001-20251030
**버전**: 1.1.0
**작성일**: 2025-10-30
**최종 수정일**: 2025-10-31
**작성자**: Product Manager (PM Agent)
**티켓**: PROJ-001
**상태**: Approved

---

## 1. 프로젝트 개요

### 1.1 프로젝트 목표

캘린더 애플리케이션에 **반복 일정 기능**을 추가하여 사용자가 매일, 매주, 매월, 매년 반복되는 일정을 효율적으로 관리할 수 있도록 한다. 이를 통해 사용자의 일정 관리 생산성을 향상시키고 반복적인 일정 입력 작업을 줄인다.

### 1.2 배경 및 동기

현재 캘린더 애플리케이션은 단일 일정만 지원하여, 매주 반복되는 회의나 매월 반복되는 업무와 같은 반복 일정을 관리하기 위해 사용자가 동일한 일정을 여러 번 수동으로 입력해야 하는 불편함이 있다. 반복 일정 기능을 추가하여 이러한 사용자의 불편을 해소하고, 일정 관리의 효율성을 높인다.

### 1.3 성공 기준

- [ ] 사용자가 반복 유형(매일, 매주, 매월, 매년)을 선택하여 반복 일정을 생성할 수 있음
- [ ] 캘린더 뷰에서 반복 일정이 아이콘으로 구분되어 표시됨
- [ ] 반복 종료 조건(특정 날짜까지)을 지정할 수 있음
- [ ] 반복 일정을 단일 또는 전체로 수정할 수 있음
- [ ] 반복 일정을 단일 또는 전체로 삭제할 수 있음
- [ ] 모든 테스트가 통과하고 테스트 커버리지 70% 이상 달성
- [ ] WCAG AA 접근성 기준 충족

---

## 2. 범위 (Scope)

### 2.1 포함 사항 (In Scope)

- 반복 유형 선택 UI (매일, 매주, 매월, 매년)
- 반복 종료 조건 설정 UI (특정 날짜까지, 최대 2025-12-31)
- 캘린더 뷰에서 반복 일정 아이콘 표시
- 반복 일정 수정 시 단일/전체 수정 선택 모달
- 반복 일정 삭제 시 단일/전체 삭제 선택 모달
- 반복 일정 생성 로직 (31일 매월 반복, 윤년 29일 매년 반복 등 엣지 케이스 처리)
- 반복 일정 데이터 모델 및 상태 관리
- 단위 테스트, 통합 테스트, E2E 테스트

### 2.2 제외 사항 (Out of Scope)

- **반복 일정 겹침 경고**: 반복 일정 생성 시 기존 일정과의 시간 겹침 검사를 수행하지 않음
  - 일반 일정은 기존대로 겹침 경고 표시
  - 반복 일정은 유연한 스케줄 관리를 위해 겹침 경고를 표시하지 않음
- 반복 횟수로 종료 조건 설정 (특정 날짜까지만 지원)
- 복잡한 반복 패턴 (예: 격주, 매월 첫째 주 월요일 등)
- 반복 일정 예외 처리 (특정 날짜 건너뛰기)
- 알림 기능
- 서버 동기화 (로컬 상태 관리만)

### 2.3 향후 고려 사항 (Future Considerations)

- 반복 횟수로 종료 조건 설정
- 복잡한 반복 패턴 지원
- 반복 일정 예외 처리
- 백엔드 API 연동

---

## 3. 주요 기능 (Features)

### Feature 1: 반복 유형 선택

**우선순위**: High

**설명**: 일정 생성 또는 수정 시 반복 유형을 선택할 수 있는 UI를 제공한다.

**핵심 요구사항**:
- 드롭다운 또는 라디오 버튼으로 반복 유형 선택 UI 제공
- 반복 유형: 없음(기본값), 매일, 매주, 매월, 매년
- 반복 유형 선택 시 반복 종료 조건 입력 필드가 표시됨 (Slide down 애니메이션)
- 특수 케이스 처리:
  - 31일에 "매월" 선택 시: 매월 31일에만 일정 생성 (31일이 없는 달은 건너뜀)
  - 윤년 29일에 "매년" 선택 시: 매년 2월 29일에만 일정 생성 (윤년이 아닌 해는 건너뜀)
- 반복 유형 데이터는 일정 객체에 `recurrence` 속성으로 저장

**Acceptance Criteria**:
- [ ] 반복 유형 드롭다운이 올바르게 렌더링됨
- [ ] 반복 유형 선택 시 onChange 이벤트가 발생함
- [ ] 반복 유형 선택 시 반복 종료 조건 필드가 표시됨
- [ ] 반복 유형이 일정 데이터에 저장됨

---

### Feature 2: 반복 일정 표시

**우선순위**: High

**설명**: 캘린더 뷰에서 반복 일정을 일반 일정과 구분하여 표시한다.

**핵심 요구사항**:
- 반복 일정에 반복 아이콘(🔁 또는 이와 유사한 아이콘) 표시
- 아이콘은 일정 제목 옆 또는 일정 카드 내부에 표시
- 시각적으로 반복 일정임을 명확히 구분
- 아이콘에 `aria-label="반복 일정"` 추가하여 접근성 확보

**Acceptance Criteria**:
- [ ] 반복 일정에 아이콘이 표시됨
- [ ] 일반 일정에는 아이콘이 표시되지 않음
- [ ] 아이콘에 적절한 aria-label이 설정됨
- [ ] 아이콘이 시각적으로 명확히 구분됨

---

### Feature 3: 반복 종료 조건

**우선순위**: High

**설명**: 반복 일정의 종료 날짜를 지정할 수 있다.

**핵심 요구사항**:
- 반복 유형 선택 시 "종료 날짜" 입력 필드 표시
- 날짜 선택기(Date Picker)로 종료 날짜 입력
- 종료 날짜는 일정 시작 날짜 이후여야 함 (검증)
- 최대 종료 날짜: 2025-12-31
- 종료 날짜까지 반복 일정을 생성
- 종료 날짜 데이터는 `recurrence.endDate` 속성으로 저장

**Acceptance Criteria**:
- [ ] 반복 유형 선택 시 종료 날짜 필드가 표시됨
- [ ] 종료 날짜가 시작 날짜 이전이면 검증 에러 표시
- [ ] 종료 날짜가 2025-12-31을 초과하면 검증 에러 표시
- [ ] 종료 날짜가 일정 데이터에 저장됨
- [ ] 종료 날짜까지만 반복 일정이 생성됨

---

### Feature 4: 반복 일정 수정

**우선순위**: High

**설명**: 반복 일정을 수정할 때 단일 일정만 수정할지, 전체 반복 일정을 수정할지 선택할 수 있다.

**핵심 요구사항**:
- 반복 일정 클릭 시 편집 모드 진입
- 편집 완료 후 저장 버튼 클릭 시 모달 표시: "해당 일정만 수정하시겠어요?"
- 모달 옵션:
  1. "예" 버튼: 해당 일정만 수정 (단일 수정)
     - 해당 일정을 반복 일정에서 분리하여 단일 일정으로 변경
     - 반복 일정 아이콘 제거
     - `recurrence` 속성 제거
  2. "아니오" 버튼: 전체 반복 일정 수정
     - 동일한 반복 그룹의 모든 일정을 수정
     - 반복 일정 아이콘 유지
     - `recurrence` 속성 유지
- 키보드 접근성: Tab, Enter, Esc 키 지원

**Acceptance Criteria**:
- [ ] 반복 일정 수정 시 선택 모달이 표시됨
- [ ] "예" 선택 시 해당 일정만 수정되고 단일 일정으로 변경됨
- [ ] "예" 선택 시 반복 아이콘이 제거됨
- [ ] "아니오" 선택 시 전체 반복 일정이 수정됨
- [ ] "아니오" 선택 시 반복 아이콘이 유지됨
- [ ] 모달이 키보드로 조작 가능함

---

### Feature 5: 반복 일정 삭제

**우선순위**: High

**설명**: 반복 일정을 삭제할 때 단일 일정만 삭제할지, 전체 반복 일정을 삭제할지 선택할 수 있다.

**핵심 요구사항**:
- 반복 일정 삭제 버튼 클릭 시 모달 표시: "해당 일정만 삭제하시겠어요?"
- 모달 옵션:
  1. "예" 버튼: 해당 일정만 삭제 (단일 삭제)
     - 해당 일정만 삭제하고 다른 반복 일정은 유지
  2. "아니오" 버튼: 전체 반복 일정 삭제
     - 동일한 반복 그룹의 모든 일정을 삭제
- 삭제 확인 후 모달 닫기
- 키보드 접근성: Tab, Enter, Esc 키 지원

**Acceptance Criteria**:
- [ ] 반복 일정 삭제 시 선택 모달이 표시됨
- [ ] "예" 선택 시 해당 일정만 삭제됨
- [ ] "예" 선택 시 다른 반복 일정은 유지됨
- [ ] "아니오" 선택 시 전체 반복 일정이 삭제됨
- [ ] 모달이 키보드로 조작 가능함

---

## 4. 사용자 및 이해관계자

### 4.1 대상 사용자 (Target Users)

- **일반 사용자**: 캘린더를 사용하여 개인 일정을 관리하는 모든 사용자
- **비즈니스 사용자**: 주기적인 회의나 업무를 관리하는 직장인
- **학생**: 수업 시간표나 정기 모임을 관리하는 학생

### 4.2 이해관계자 (Stakeholders)

- **Product Manager**: 프로젝트 전반 관리 및 요구사항 정의
- **Frontend Developers**: 기능 구현 및 테스트
- **QA Engineer**: 품질 검증 및 테스트
- **UX Designer**: 사용자 인터페이스 및 경험 설계

---

## 5. 기술 스택 및 요구사항

### 5.1 기술 스택

- **프레임워크**: React 18.x
- **언어**: TypeScript
- **상태 관리**: Zustand (전역 상태 관리)
- **스타일링**: Tailwind CSS
- **날짜 라이브러리**: date-fns (날짜 계산 및 포맷팅)
- **테스트**: Vitest, React Testing Library
- **E2E 테스트**: Playwright 또는 Cypress
- **빌드 도구**: Vite

### 5.2 성능 요구사항

- **로딩 시간**: 초기 로딩 3초 이내
- **번들 사이즈**: 500KB 이하
- **렌더링 성능**: 60fps 유지, 부드러운 애니메이션
- **반복 일정 생성 시간**: 1년치 반복 일정(최대 365개) 생성 시 500ms 이내

### 5.3 접근성 요구사항

- **WCAG 기준**: AA 수준 준수
- **키보드 네비게이션**: 모든 기능 키보드로 접근 가능 (Tab, Enter, Esc)
- **스크린 리더**: 모든 UI 요소에 적절한 aria-label 제공
- **색상 대비**: 4.5:1 이상
- **포커스 표시**: 포커스된 요소의 아웃라인 명확히 표시

### 5.4 테스트 커버리지 목표

- **단위 테스트**: 70% 이상
- **통합 테스트**: 주요 사용자 플로우 커버 (반복 일정 생성, 수정, 삭제)
- **E2E 테스트**: 핵심 기능 커버 (반복 일정 생성부터 삭제까지 전체 플로우)

---

## 6. 제약사항 (Constraints)

### 6.1 일정 및 리소스

- **예상 기간**: 2주 (TDD 워크플로우 포함)
- **팀 구성**: Frontend 1명, QA 1명 (에이전트 기반 워크플로우)
- **마일스톤**:
  - Week 1: PRD → Test Designer → Test Writer → Implementer
  - Week 2: QA → Refactorer → Doc Keeper

### 6.2 기술 제약사항

- 반복 일정 생성 시 겹침 경고를 표시하지 않음 (설계 의도: 유연한 스케줄 관리)
- 최대 종료 날짜: 2025-12-31
- 로컬 상태 관리만 지원 (서버 동기화 없음)
- 브라우저 지원: Chrome, Firefox, Safari, Edge 최신 버전

### 6.3 데이터 제약사항

- 반복 일정은 고유한 `recurrenceId`로 그룹화
- 반복 일정 생성 시 최대 365개까지 생성 가능 (1년치)
- 단일 수정된 일정은 원본 반복 그룹과 연결 해제

---

## 7. 의존성 (Dependencies)

### 7.1 외부 의존성

- **date-fns**: 날짜 계산 및 반복 패턴 생성
- **React**: UI 렌더링
- **Zustand**: 전역 상태 관리

### 7.2 내부 의존성

- 기존 캘린더 뷰 컴포넌트
- 기존 일정 생성/수정/삭제 로직
- 기존 일정 데이터 모델 (확장 필요)

---

## 8. 데이터 모델

### 8.1 Event 데이터 구조 (확장)

```typescript
interface Event {
  id: string;
  title: string;
  date: Date;
  description?: string;
  category?: string;

  // 반복 일정 관련 추가 필드
  recurrence?: {
    type: 'daily' | 'weekly' | 'monthly' | 'yearly';
    endDate: Date;
    recurrenceId: string; // 동일한 반복 그룹을 식별하는 ID
  };
}
```

### 8.2 반복 일정 생성 로직

- 반복 유형에 따라 시작 날짜부터 종료 날짜까지 반복 일정 배열 생성
- 각 반복 일정은 동일한 `recurrenceId`를 가짐
- 매월 반복 시 31일 처리:
  - 31일이 없는 달(2월, 4월, 6월, 9월, 11월)은 건너뜀
- 매년 반복 시 2월 29일 처리:
  - 윤년이 아닌 해는 건너뜀
  - `date-fns`의 `isLeapYear` 함수 사용

---

## 9. 리스크 및 가정 사항

### 9.1 주요 리스크

| 리스크 | 영향도 | 확률 | 완화 방안 |
|--------|--------|------|-----------|
| 반복 일정 생성 로직 복잡도 증가 | High | Medium | TDD 방식으로 엣지 케이스를 충분히 테스트 |
| 성능 저하 (대량의 반복 일정 생성 시) | Medium | Low | 반복 일정 생성을 최적화하고 최대 365개로 제한 |
| 사용자 혼란 (단일/전체 수정 선택) | Medium | Medium | 명확한 모달 문구와 예시 제공 |
| 윤년 및 31일 처리 로직 오류 | High | Low | 철저한 단위 테스트 및 엣지 케이스 커버 |

### 9.2 가정 사항 (Assumptions)

- 사용자는 반복 일정 개념을 이해하고 있음
- 반복 일정 겹침은 사용자가 직접 관리함
- 로컬 스토리지에 일정 데이터를 저장하며, 브라우저 용량 제한 내에서 관리 가능
- date-fns 라이브러리가 안정적으로 동작함

---

## 10. UI/UX 요구사항

### 10.1 반복 유형 선택 UI

- 드롭다운 또는 라디오 버튼 (결정: 드롭다운 사용)
- 레이블: "반복"
- 옵션: 없음(기본값), 매일, 매주, 매월, 매년
- 반복 유형 선택 시 종료 날짜 필드가 Slide down 애니메이션으로 표시 (0.3초)

### 10.2 종료 날짜 입력 UI

- 레이블: "종료 날짜"
- Date Picker 컴포넌트
- 최소 날짜: 일정 시작 날짜 + 1일
- 최대 날짜: 2025-12-31
- 검증 에러 메시지:
  - "종료 날짜는 시작 날짜 이후여야 합니다."
  - "종료 날짜는 2025-12-31까지 선택 가능합니다."

### 10.3 반복 아이콘

- 아이콘: 🔁 (또는 Font Awesome/Heroicons의 반복 아이콘)
- 위치: 일정 제목 옆 (또는 일정 카드 우측 상단)
- 크기: 16px
- 색상: 테마 색상 (예: blue-500)
- aria-label: "반복 일정"

### 10.4 수정/삭제 확인 모달

- 제목:
  - 수정: "반복 일정 수정"
  - 삭제: "반복 일정 삭제"
- 메시지:
  - 수정: "해당 일정만 수정하시겠어요?"
  - 삭제: "해당 일정만 삭제하시겠어요?"
- 버튼:
  - "예" (primary button)
  - "아니오" (secondary button)
  - "취소" (tertiary button, optional)
- 키보드 지원: Tab(포커스 이동), Enter(확인), Esc(취소)
- 포커스 트랩: 모달 내부에만 포커스 유지

---

## 11. 승인 및 이력

### 11.1 승인

- **PM**: Product Manager (PM Agent) - 2025-10-30
- **기술 리드**: Approved - 2025-10-30

### 11.2 변경 이력

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|-----------|
| 1.0.0 | 2025-10-30 | PM Agent | 초안 작성 |
| 1.1.0 | 2025-10-31 | Doc Keeper | 반복 일정 겹침 경고 관련 명확화: 반복 일정 생성 시 겹침 검사를 수행하지 않음을 명시 |

---

**다음 단계**: Test Designer에게 전달 (티켓: PROJ-002)

**참조 문서**:
- **워크플로우**: `.claude/docs/workflows.md`
- **PM 체크리스트**: `.claude/docs/check-lists/pm-checklist.md`
