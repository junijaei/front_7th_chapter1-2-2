# 에이전트 생성 가이드라인

이 문서는 **LLM이 새로운 에이전트를 생성할 때 반드시 따라야 하는 기준**을 정의한다.  
모든 에이전트는 명확한 역할, 책임, 입출력 구조를 가져야 하며 기존 워크플로우와의 정합성을 유지해야 한다.

---

## 1. 기본 원칙
1. 에이전트는 **하나의 명확한 목적**과 **책임 범위(Scope)** 를 가진다.  
2. 이미 존재하는 에이전트와 **역할이 중복되지 않아야** 한다.  
3. 다른 에이전트와의 **데이터 의존성 및 전달 흐름**을 명확히 정의한다.  
4. 생성되는 에이전트는 **독립 실행 가능**해야 하며, 외부 파일 의존 시 명시적으로 참조해야 한다.  
5. 모든 산출물은 **Markdown 형식**을 기본으로 하며, 코드 작성이 필요한 경우에만 코드 파일을 출력한다.

---

## 2. 생성 절차

### ⚠️ 필수 준수 사항

**모든 에이전트 생성 시 아래 절차를 반드시 따른다. 이 절차를 건너뛰는 것은 금지된다.**

### 2.1 단계별 생성 및 승인 절차

에이전트 생성은 **반드시 다음 순서**를 따르며, **각 단계마다 사용자 승인을 받아야만** 다음 단계로 진행할 수 있다.

#### 단계 1: 에이전트 프롬프트 작성
1. **프롬프트 파일 작성**: `.claude/agents/[agent-name].md`
2. **사용자에게 검토 요청**: "에이전트 프롬프트를 작성했습니다. 검토 후 승인해주세요."
3. **승인 대기**: 사용자가 명시적으로 승인("진행", "OK", "승인" 등)할 때까지 대기
4. **피드백 반영**: 수정 요청 시 즉시 반영 후 재검토 요청
5. ✅ **승인 후에만 단계 2로 진행**

#### 단계 2: 출력 템플릿 작성
1. **템플릿 파일 작성**: `.claude/docs/templates/[agent-name]-output.md`
2. **사용자에게 검토 요청**: "출력 템플릿을 작성했습니다. 검토 후 승인해주세요."
3. **승인 대기**: 사용자가 명시적으로 승인할 때까지 대기
4. **피드백 반영**: 수정 요청 시 즉시 반영 후 재검토 요청
5. ✅ **승인 후에만 단계 3으로 진행**

#### 단계 3: 체크리스트 작성
1. **체크리스트 파일 작성**: `.claude/docs/check-lists/[agent-name]-checklist.md`
2. **사용자에게 검토 요청**: "체크리스트를 작성했습니다. 검토 후 승인해주세요."
3. **승인 대기**: 사용자가 명시적으로 승인할 때까지 대기
4. **피드백 반영**: 수정 요청 시 즉시 반영 후 재검토 요청
5. ✅ **승인 후에만 단계 4로 진행**

#### 단계 4: 기존 파일 업데이트
1. **workflows.md 업데이트**: 에이전트 워크플로우 추가
2. **Upstream 에이전트 프롬프트 업데이트**: 다음 단계 에이전트 참조 정보 추가
3. **사용자에게 검토 요청**: "기존 파일을 업데이트했습니다. 최종 검토 후 승인해주세요."
4. **승인 대기**: 사용자가 명시적으로 승인할 때까지 대기
5. ✅ **최종 승인 후 완료**

### 2.2 승인 기준

사용자는 다음 기준에 따라 각 단계를 승인한다:

- [ ] 문서의 구조, 내용, 형식이 요구사항을 충족하는가
- [ ] 기존 시스템 및 워크플로우와의 정합성이 확보되었는가
- [ ] 다른 에이전트와의 역할 중복이 없는가
- [ ] 입출력 명세가 명확한가
- [ ] 사용자가 명시적으로 "진행", "OK", "승인" 등의 피드백을 제공했는가

### 2.3 금지 사항

**다음 행동은 절대 금지된다:**

❌ **승인 없이 다음 단계로 진행하는 것**
❌ **여러 문서를 한 번에 생성하는 것**
❌ **사용자 피드백을 기다리지 않고 계속 진행하는 것**
❌ **암묵적 승인을 가정하는 것** (명시적 승인만 유효)

### 2.4 워크플로우 예시

**올바른 절차:**
```
1. 프롬프트 작성 → 사용자에게 검토 요청 → 승인 대기
2. [사용자 승인 후] 템플릿 작성 → 사용자에게 검토 요청 → 승인 대기
3. [사용자 승인 후] 체크리스트 작성 → 사용자에게 검토 요청 → 승인 대기
4. [사용자 승인 후] 기존 파일 업데이트 → 사용자에게 검토 요청 → 최종 승인
```

**잘못된 절차 (금지):**
```
❌ 프롬프트 + 템플릿 + 체크리스트를 한꺼번에 작성 후 검토 요청
❌ 프롬프트 작성 → 승인 없이 템플릿 작성 시작
❌ "검토 부탁드립니다"라는 말 없이 다음 단계 진행
```

### 2.5 원칙

1. **모든 에이전트 생성은 전체 시스템에 영향을 미친다** - 신중하게 검증한다
2. **사용자 승인은 필수이며 건너뛸 수 없다** - 예외 없음
3. **각 문서는 독립적으로 검증되어야 한다** - 단계별 승인 필수
4. **피드백은 즉시 반영하고 재검토를 요청한다** - 수정 후 재승인 필요

---

## 3. 생성 시 고려사항
1. **역할 정의**
   - 수행 목적, 주요 기능, 제약사항을 간결하게 기술한다.  
   - 중복되는 책임이 없는지 반드시 확인한다.
2. **입출력 명세**
   - 입력 데이터의 형식과 출력 형식을 명확히 정의한다.  
   - 다른 에이전트와의 인터페이스 규칙을 준수한다.
3. **워크플로우 연동**
   - 어느 단계에서 동작하며, 결과를 누구에게 전달하는지 명시한다.  
   - “다음 에이전트” 항목을 반드시 포함한다.
4. **버전 관리**
   - 생성된 모든 문서는 버전 번호와 생성 일자를 포함한다.  
   - 변경 이력은 `.claudes/docs/changelogs`에 기록한다.

---

## 4. 디렉토리 구조
```
.claudes/
├─ agents/           # 실제 에이전트 정의 파일
├─ docs/
│   ├─ check-lists/  # 검증용 체크리스트
│   ├─ templates/    # 출력 템플릿
│   ├─ specs/        # I/O 및 데이터 구조 정의
│   ├─ workflows/    # 에이전트 간 데이터 흐름 정의
│   └─ changelogs/   # 변경 이력
```

---

## 5. 자주 하는 실수 및 방지 기준

### 5.1 책임 중복
- **잘못된 예시:**  
  - 기존 에이전트: “기능 요구사항 정의”  
  - 신규 에이전트: “기능 명세 작성”  
  → 이름만 다르고 같은 책임이면 **중복**
- **올바른 원칙:**  
  - 역할의 범위, 산출물, 상위/하위 관계를 명확히 구분해야 함.

### 5.2 입력 불명확
- **잘못된 예시:** “프로젝트 정보”  
- **올바른 예시:** “Requirements.md (요구사항 명세서)”  
→ 입력 파일이나 데이터의 **정확한 출처**를 명시해야 함.

### 5.3 Handoff 누락
- **원칙:**  
  프롬프트에 **“다음 에이전트” 섹션이 반드시 포함**되어야 함.  
  다음 단계로 결과가 전달되지 않으면 워크플로우가 단절된다.

### 5.4 Context Loss
- **잘못된 예시:** “자세한 내용은 다른 문서 참고”  
- **올바른 예시:** “이 파일에 모든 필요 정보 포함”  
→ 프롬프트는 항상 **자급자족(self-contained)** 구조로 작성해야 함.

### 5.5 제약 불명확
- **잘못된 예시:** “기술 스택 선택하지 말 것”  
- **올바른 예시:** “새로운 라이브러리 추천 금지 (Architect의 몫)”  
→ 제약사항은 **행위의 범위와 책임 주체**를 명확히 지정해야 함.

---

## 6. 생성 체크리스트
- [ ] 명확한 역할과 책임이 정의되어 있는가  
- [ ] 기존 에이전트와 기능이 중복되지 않는가  
- [ ] 입출력 형식이 명확하게 규정되어 있는가  
- [ ] 워크플로우 상 위치와 다음 에이전트가 정의되어 있는가  
- [ ] 체크리스트와 버전 관리 절차를 준수했는가  
- [ ] 프롬프트가 자급자족적이며 의존 정보가 누락되지 않았는가  

---

**이 문서는 LLM이 새로운 에이전트를 생성할 때 반드시 준수해야 하는 표준 절차이다.**